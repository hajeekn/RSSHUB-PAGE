
---
title: '这个赛车AI不再只图一时爽，学会了考虑长远策略'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb99a_1024.jpg'
author: ZAKER
comments: false
date: Tue, 22 Mar 2022 00:33:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb99a_1024.jpg'
---

<div>   
<p>玩赛车游戏的 AI 们现在已经不仅仅是图快图爽了。</p><p>他们开始考虑战术规划，甚至有了自己的行车风格和 " 偏科 " 项目。</p><p>比如这位只擅长转弯的 " 偏科 " 选手，面对急弯我重拳出击，惊险漂移，面对直线我唯唯诺诺，摇晃不停：</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_0" data-original="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb99a_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb99a_raw.gif" data-height="462" data-width="852" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb99a_1024.jpg" referrerpolicy="no-referrer"></div></div>还有具备长远目光，学会了战术规划的 AI，也就是这两位正在竞速的中的绿色赛车，看似在转弯处减缓了速度，却得以顺利通过急弯，免于直接 GG 的下场。<p></p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_1" data-original="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb99b_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb99b_raw.gif" data-height="460" data-width="846" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb99b_1024.jpg" referrerpolicy="no-referrer"></div></div>还有面对不管是多新的地图，都能举一反三，跑完全程的 AI。<p></p><p>看起来就像是真的在赛车道上学会了思考一样。</p><p>（甚至上面所说的那位偏科选手还在不懈努力后成功逆袭了）</p><p>这项训练结果一经公布，便吸引了大批网友的围观：</p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_2" data-original="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb99d_1024.jpg" data-height="705" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb99d_1024.jpg" referrerpolicy="no-referrer"></div></div><b>强化学习让 AI 学会 " 长远考虑 "</b><p></p><p>训练赛道来自一款叫做《赛道狂飙》（Trackmania）的游戏，以可深度定制的赛道编辑器闻名于玩家群体。</p><p>为了更大程度上激发赛车 AI 的潜力，开发者自制了这样一张九曲十八弯的魔鬼地图：</p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_3" data-original="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb99e_1024.jpg" data-height="716" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb99e_1024.jpg" referrerpolicy="no-referrer"></div></div>这位开发者名叫<strong>yoshtm</strong>，之间就已经用 AI 玩过这款游戏，一度引发热议：<p></p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb99f_1024.jpg" data-height="705" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb99f_1024.jpg" referrerpolicy="no-referrer"></div></div>一开始，yoshtm 采用的是一种监督学习模型，拥有 2 个隐藏层。<p></p><p>模型包含了 16 个输入，包括如汽车当前速度、加速度、路段位置等等，再通过神经网络对输入参数进行分析，最终输出 6 种动作中的一种：</p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_5" data-original="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a0_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a0_raw.gif" data-height="460" data-width="846" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a0_1024.jpg" referrerpolicy="no-referrer"></div></div>基于这一模型架构，开发者让多只 AI 在同一张地图上竞争。<p></p><p>通过多次迭代，不同 AI 的神经网络会出现细微的差别，结果最好的 AI 将最终脱颖而出。</p><p>这种方法确实能让 AI 学会驾驶，不过也带来了一个问题：</p><p>AI 常常只能以速度或最终冲线的时间等<strong>单一指标</strong>来评估自己，难以更进一步。</p><p>这次，时隔两年后的赛车 AI，不仅学会了从长远出发制定策略（比如在急弯时对速度作出调整），还大幅提高了<strong>对新地图的适应性</strong>。</p><p>主要原因就来自于开发者这次引入的新方法，<strong>强化学习</strong>。</p><p>这种方法的核心概念是 " 奖励 "，即通过选择带来更多奖励的行为，来不断优化最终效果。</p><p>在训练赛车游戏中的 AI 时，yoshtm 定义的奖励很常规：速度越快奖励越多，走错路或掉下赛道就会惩罚。</p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_6" data-original="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a1_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a1_raw.gif" data-height="460" data-width="846" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a1_1024.jpg" referrerpolicy="no-referrer"></div></div>但问题是，一些行动，比如在临近转弯时的加速或许能导致短期的正面奖励，但从长远来看却可能会产生负面的后果。<p></p><p>于是，yoshtm 采用了一种叫做<strong>Deep Q Learning</strong>的方法。</p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a2_1024.jpg" data-height="294" data-width="650" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a2_1024.jpg" referrerpolicy="no-referrer"></div></div>这是一种无模型的强化学习技术，对于给定状态，它能够比较可用操作的预期效用，同时还不需要环境模型。<p></p><p>Deep Q Learning 会通过深度网络参数 的学习不断提高 Q 值预测的准确性，也就是说，能够使 AI 在赛车游戏中预测每个可能的行动的<strong>预期累积奖励</strong>，从而 " 具备一种长远的策略目光 "。</p><p><b>随机出生点帮 AI 改正 " 偏科 "</b></p><p>接下来开始进行正式训练。</p><p>yoshtm 的思路是，AI 会先通过随机探索来尽可能多地收集地图数据，他将这一行为称之为<strong>探索</strong>。</p><p>探索的比例越高，随机性也就越强，而随着比例降低，AI 则会更加专注于赢取上述设置的奖励，也即专注于跑图。</p><p></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_8" data-original="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb9a3_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb9a3_raw.gif" data-height="462" data-width="852" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb9a3_1024.jpg" referrerpolicy="no-referrer"></div></div>不过，在训练了近 3 万次，探索比例降低到 5% 时，AI" 卡关 " 了：<p></p><p></p><div class="img_box" id="id_imagebox_9" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_9" data-original="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a4_1024.jpg" data-height="604" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a4_1024.jpg" referrerpolicy="no-referrer"></div></div>核心问题是 AI 出现了 " 偏科 "。<p></p><p>由于前期经历了多个弯道的跑图，所以 AI 出现了<strong>过拟合</strong>现象，面对长直线跑道这种新的赛道类型，一度车身不稳，摇摇晃晃，最终甚至选择了 " 自杀 "：</p><p></p><div class="img_box" id="id_imagebox_10" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_10" data-original="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb9a5_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb9a5_raw.gif" data-height="462" data-width="852" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb9a5_1024.jpg" referrerpolicy="no-referrer"></div></div>要如何解决这个问题呢？<p></p><p>yoshtm 并没有选择重新制作地图，而是选择修改 AI 的出生点：</p><p>每次开始训练时，AI 的出发点都将在地图上的一个随机位置生成，同时速度和方向也会随机。</p><p></p><div class="img_box" id="id_imagebox_11" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_11" data-original="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a6_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a6_raw.gif" data-height="347" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202203/62397ded8e9f095e624bb9a6_1024.jpg" referrerpolicy="no-referrer"></div></div>这一办法立竿见影，AI 终于开始能够完整跑完一条赛道了。<p></p><p>接下来就是进行不断训练，最终，开发者 yoshtm 和 AI 比了一场，AI 在这次跑到了最好成绩：<strong>6 分 20 秒</strong>。</p><p></p><div class="img_box" id="id_imagebox_12" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_12" data-original="http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb9a7_1024.jpg" data-height="604" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202203/62397ded8e9f095e624bb9a7_1024.jpg" referrerpolicy="no-referrer"></div></div>虽然还是没有真人操控的赛车跑得快，不过 AI 表现出了较强的场地适应性，对草地还是泥地都能立马举一反三。<p></p><p>yoshtm 最后这样说道：</p><p>《赛车狂飙》本来就是一个需要大量训练的游戏，AI 当然也如此。</p><p>至少我现在很确定，这个 AI 可以打败大量的初学者。</p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            