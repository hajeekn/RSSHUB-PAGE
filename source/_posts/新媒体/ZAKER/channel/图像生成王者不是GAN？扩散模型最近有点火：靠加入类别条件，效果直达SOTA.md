
---
title: '图像生成王者不是GAN？扩散模型最近有点火：靠加入类别条件，效果直达SOTA'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585282_1024.jpg'
author: ZAKER
comments: false
date: Wed, 29 Dec 2021 05:32:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585282_1024.jpg'
---

<div>   
<p>OpenAI 刚刚推出的年末新作 GLIDE，又让<strong>扩散模型</strong>小火了一把。</p><p>这个基于扩散模型的文本图像生成大模型参数规模更小，但生成的图像质量却更高。</p><p>于是，依旧是 OpenAI 出品，论文标题就直接号称 " 在图像生成上打败 GAN" 的<strong>ADM-G 模型</strong>也重新进入了大众眼中：</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_0" data-original="http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585282_1024.jpg" data-height="326" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585282_1024.jpg" referrerpolicy="no-referrer"></div></div>光看 Papers with Code 上基于 ImageNet 数据集的图像生成模型榜单，从 64 x 64 到 512 x 512 分辨率都由这一模型占据榜首：<p></p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_1" data-original="http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585283_1024.jpg" data-height="910" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585283_1024.jpg" referrerpolicy="no-referrer"></div></div>对比曾号称史上最强图像生成器的 BigGAN-deep 也不落下风，甚至还能在 LSUN 和 ImageNet 64 × 64 的图像生成效果上达到 SOTA。<p></p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_2" data-original="http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585284_1024.jpg" data-height="730" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585284_1024.jpg" referrerpolicy="no-referrer"></div></div>有网友对此感叹：前几年图像生成领域一直由 GAN 主导，现在看来，似乎要变成扩散模型了。<p></p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_3" data-original="http://zkres1.myzaker.com/202112/61cc50da8e9f095b94585285_1024.jpg" data-height="98" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202112/61cc50da8e9f095b94585285_1024.jpg" referrerpolicy="no-referrer"></div></div><b>加入类别条件的扩散模型</b><p></p><p>我们先来看看扩散模型的定义。</p><p>这是一种新的图像生成的方法，其名字中的 " 扩散 " 本质上是一个迭代过程。</p><p>具体到推理中，就是从一幅完全由噪声构成的图像开始，通过预测每个步骤滤除的噪声，迭代去噪得到一个高质量的样本，然后再逐步添加更多的细节。</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_4" data-original="http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585286_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585286_raw.gif" data-height="512" data-width="512" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585286_1024.jpg" referrerpolicy="no-referrer"></div></div>而 OpenAI 的这个 ADM-G 模型，则是在此基础上向图像生成任务中加入了<strong>类别条件</strong>，形成了一种独特的消融扩散模型。<p></p><p>研究人员分别从以下几个方面做了改进：</p><p><b>基本架构</b></p><p>基于 UNet 结构做了五点改进：</p><p>在保持模型大小不变的前提下，增加深度与宽度</p><p>增加注意头（Attention Head）数量</p><p>在 32 × 32、16 × 16 和 8 × 8 的分辨率下都使用注意力机制</p><p>使用 BigGAN 残差块对激活函数进行上采样和下采样</p><p>将残差连接（Residual Connections）缩小为原来的 1/ 根号 2</p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_5" data-original="http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585287_1024.jpg" data-height="612" data-width="900" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202112/61cc50da8e9f095b94585287_1024.jpg" referrerpolicy="no-referrer"></div></div><b>类别引导（Classifier Guidance）</b><p></p><p>在噪声逐步转换到信号的过程中，研究人员引入了一个预先训练好的分类网络。</p><p>它能够为中间生成图像预测并得到一个标签，也就是可以对生成的图片进行分类。</p><p>之后，再基于分类分数和目标类别之间的交叉熵损失计算梯度，用梯度引导下一步的生成采样。</p><p><b>缩放分类梯度（Scaling Classifier Gradients）</b></p><p>按超参数缩放分类网络梯度，以此来控制生成图像的多样性和精度。</p><p>比如像这样，左边是 1.0 规模大小的分类网络，右边是 10.0 大小的分类网络，可以看到，右边的生成图像明显类别更加一致：</p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres1.myzaker.com/202112/61cc50da8e9f095b94585288_1024.jpg" data-height="264" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202112/61cc50da8e9f095b94585288_1024.jpg" referrerpolicy="no-referrer"></div></div>也就是说，分类网络梯度越高，类别就越一致，精度也越高，而同时多样性也会变小。<p></p><p><b>生成领域的新热点</b></p><p>目前，这一模型在 GitHub 上已有近千标星：</p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres1.myzaker.com/202112/61cc50da8e9f095b94585289_1024.jpg" data-height="142" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202112/61cc50da8e9f095b94585289_1024.jpg" referrerpolicy="no-referrer"></div></div>而与 GAN 比起来，扩散模型生成的图像还更多样、更复杂。<p></p><p>基于同样的训练数据集时，扩散模型可以生成拥有全景、局部特写、不同角度的图像：</p><p><strong></strong></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div perview_img_div"><strong><img class="lazy opacity_0 " id="img_8" data-original="http://zkres1.myzaker.com/202112/61cc50da8e9f095b9458528a_1024.jpg" data-height="260" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202112/61cc50da8e9f095b9458528a_1024.jpg" referrerpolicy="no-referrer"></strong></div></div><strong>△</strong>左：BigGAN-deep 右：ADM<p></p><p>其实，自 2020 年谷歌发表 DDPM 后，扩散模型就逐渐成为了生成领域的一个新热点，</p><p>除了文章中提到的 OpenAI 的两篇论文之外，还有 Semantic Guidence Diffusion、Classifier-Free Diffusion Guidence 等多个基于扩散模型设计的生成模型。</p><p>扩散模型接下来还会在视觉任务上有哪些新的应用呢，我们来年再看。</p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            